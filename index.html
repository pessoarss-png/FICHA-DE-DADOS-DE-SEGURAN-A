<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Biblioteca de Fichas de Seguran√ßa</title>
  <meta name="description" content="Lista autom√°tica de FDS e FISPQ a partir do reposit√≥rio do GitHub">
  <style>
    :root { --gap:1rem; --radius:16px; }
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.5}
    .container{max-width:1000px;margin:0 auto;padding:1.5rem}
    h1{margin:0 0 .5rem} h2{margin:2rem 0 .5rem}
    #search{width:100%;padding:.75rem 1rem;border:1px solid #ddd;border-radius:var(--radius);font-size:1rem}
    .grid{list-style:none;padding:0;margin:var(--gap) 0 0;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:var(--gap)}
    .card a{display:block;padding:1rem;border:1px solid #eee;border-radius:var(--radius);text-decoration:none;color:inherit;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,.03)}
    .card a:hover{border-color:#ddd;box-shadow:0 3px 12px rgba(0,0,0,.06)}
    .title{display:block;font-weight:600;margin-bottom:.25rem}.meta{display:block;font-size:.9rem;color:#666}
    footer{border-top:1px solid #eee;margin-top:2rem}
    .muted{color:#777;font-size:.95rem}
    @media (prefers-color-scheme: dark){
      body{background:#0b0b0b;color:#eaeaea}
      #search{background:#161616;border-color:#333;color:#eaeaea}
      .card a{background:#121212;border-color:#222}
      .card a:hover{border-color:#2d2d2d;box-shadow:0 3px 14px rgba(0,0,0,.35)}
      footer{border-color:#1f1f1f}
      .muted{color:#a0a0a0}
    }
  </style>
</head>
<body>
  <header class="container">
    <h1>üìö Fichas de Dados de Seguran√ßa</h1>
    <p class="muted">Os PDFs s√£o listados automaticamente do reposit√≥rio.</p>
    <input id="search" type="search" placeholder="Pesquisar‚Ä¶ (ex.: WD-40, Molykote, Loctite)">
  </header>

  <main class="container">
    <section>
      <h2>FDS</h2>
      <ul id="lista-fds" class="grid"></ul>
    </section>
    <section>
      <h2>FISPQ</h2>
      <ul id="lista-fispq" class="grid"></ul>
    </section>
    <p id="status" class="muted"></p>
  </main>

  <footer class="container" style="font-size:.9rem">
    √öltima atualiza√ß√£o: <span id="updated"></span>
  </footer>

  <script>
    // ====== CONFIGURADO PARA SEU REPO ======
    const USERNAME = "pessoarss-png";        
    const REPO     = "FICHA-DE-DADOS-DE-SEGURAN-A";    
    const BRANCH   = "main";               
    const FOLDER   = "";                   
    // ========================================

    const statusEl = document.getElementById("status");
    document.getElementById("updated").textContent = new Date().toLocaleDateString("pt-BR");

    const apiURL = `https://api.github.com/repos/${USERNAME}/${REPO}/contents/${FOLDER}?ref=${encodeURIComponent(BRANCH)}`;

    function pagesHref(name) {
      const relBase = location.pathname.replace(/\/[^\/]*$/, "/");
      const path = (FOLDER + name).split("/").map(encodeURIComponent).join("/");
      return relBase + path;
    }

    function niceTitle(name) {
      return name.replace(/\.pdf$/i, "")
                 .replace(/^(FDS|FISPQ)\s*/i, "")
                 .trim();
    }

    function cardLi(name) {
      const li = document.createElement("li");
      li.className = "card";
      li.innerHTML = `
        <a href="${pagesHref(name)}" target="_blank" rel="noopener">
          <span class="title">${niceTitle(name)}</span>
          <span class="meta">PDF</span>
        </a>`;
      return li;
    }

    async function load() {
      try {
        statusEl.textContent = "Carregando lista de arquivos‚Ä¶";
        const resp = await fetch(apiURL, { headers: { "Accept": "application/vnd.github+json" } });
        if (!resp.ok) throw new Error("Falha na API do GitHub (" + resp.status + ")");
        const items = await resp.json();

        const pdfs = items
          .filter(x => x.type === "file" && /\.pdf$/i.test(x.name))
          .map(x => x.name);

        if (pdfs.length === 0) {
          statusEl.textContent = "Nenhum PDF encontrado.";
          return;
        }

        const fds   = pdfs.filter(n => /^FDS\b/i.test(n));
        const fispq = pdfs.filter(n => /^FISPQ\b/i.test(n));

        fds.sort((a,b)=>a.localeCompare(b, 'pt-BR', {sensitivity:'base'}));
        fispq.sort((a,b)=>a.localeCompare(b, 'pt-BR', {sensitivity:'base'}));

        const elFds = document.getElementById("lista-fds");
        const elFispq = document.getElementById("lista-fispq");

        fds.forEach(n => elFds.appendChild(cardLi(n)));
        fispq.forEach(n => elFispq.appendChild(cardLi(n)));

        statusEl.textContent = "";
      } catch (e) {
        statusEl.textContent = "Erro ao carregar lista. Verifique se USERNAME/REPO/BRANCH est√£o corretos.";
        console.error(e);
      }
    }

    const search = document.getElementById("search");
    search.addEventListener("input", () => {
      const q = search.value.toLowerCase().trim();
      document.querySelectorAll(".card").forEach(card => {
        card.style.display = card.textContent.toLowerCase().includes(q) ? "" : "none";
      });
    });

    load();
  </script>
</body>
</html>
